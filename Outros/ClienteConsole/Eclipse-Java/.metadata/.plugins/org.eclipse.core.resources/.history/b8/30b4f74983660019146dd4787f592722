package clientews;

import java.io.*; //BufferedReader, InputStreamReader
import java.net.*; //url, httpurlconnection
import com.google.gson.Gson; //to Json

public class ClienteWS
{
	private static String chamarMetodoServidor(String url, String tipoMetodo, Object... arguments)
    {
        //URL
        URL objURL = new URL(url);
        HttpURLConnection con = (HttpURLConnection) objURL.openConnection();

        //conexao com WebService
        con.setRequestMethod(tipoMetodo);
        con.setRequestProperty("Content-Type", "application/json");
        
        //Passar objetos como parametros para o WebService
        if (arguments.length > 0)
        {
        	OutputStream os = con.getOutputStream();
            for (Object agr : arguments)
            {
                //Formata em json o item da lista a ser inserido com POST
                String jsonFromObj = new Gson.toJson(arg);

                //Escreve o output tranformado em Bytes
                os.write(jsonFromObj.getBytes());
            }
        }

        //response code
        int responseCode = con.getResponseCode();

        //retorno do metodo
        BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(con.getInputStream()));
        String inputLine;
        StringBuffer response = new StringBuffer();
        while((inputLine = bufferedReader.readLine()) != null)
            response.append(inputLine);
        String jsonReturn = response.toString(); // retorno em JSON

        bufferedReader.close();
        con.disconnect();
        
        return jsonReturn;
    }
}
